hgts_is_level_3_player_crisis = {
    OR = {
        has_crisis_level = crisis_level_3
        has_crisis_level = crisis_cosmogenesis_level_3
        has_crisis_level = crisis_behemoth_level_3
    }
}

hgts_is_definitive_crisis = {
    OR = {
        OR = {
            hgts_is_level_3_player_crisis = yes
            is_level_4_player_crisis = yes
            is_level_5_player_crisis = yes
        }
        has_origin = origin_endbringers
    }
}

# Checks if a scoped system is partially or fully controlled by an enemy of the given target country
# Supported Scope: galactic_object
# Parameter: enemy_of = <target>
hgts_partially_controlled_by_enemy_of = {
    is_scope_type = galactic_object
    # To use:
    # is_at_war_with = target
    # controller = {}
    OR = {
        AND = {
            exists = starbase
            starbase = {
                exists = controller
                controller = {
                    is_at_war_with = $enemy_of$
                }
            }
        }
        any_system_planet = {
            exists = controller
            controller = {
                is_at_war_with = $enemy_of$
            }
        }
    }
}

# Checks if a scoped system is fully controlled by an ally of the given target country
# Supported Scope: galactic_object
# Parameter: ally_of = <target>
hgts_fully_controlled_by_ally = {
    is_scope_type = galactic_object
    AND = {
        exists = starbase
        starbase = {
            controller = {
                OR = {
                    is_same_value = $ally_of$
                    is_in_federation_with = $ally_of$
                }
            }
        }
        count_system_planet = {
            count = all
            limit = {
                OR = {
                    has_owner = no
                    controller = {
                        OR = {
                            is_same_value = $ally_of$
                            is_in_federation_with = $ally_of$
                        }
                    }
                }
            }
        }
    }
}


