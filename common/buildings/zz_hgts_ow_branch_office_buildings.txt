###########################
# Branch Office Buildings #
###########################

## N.B.: ai_weight is still used for branch offices!

@traders_from_civic = 200
@crime_floor_from_legal_crime = 5
@trade_value_from_jobs = 0.01

## REGULAR MEGACORP ##


building_commercial_forum = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	planet_modifier = {
		job_trader_add = 200
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_trading_posts
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_franchising
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_memory_vault_corporate
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = { is_illegal_criminal = yes }
	}

	convert_to = {
		building_smuggling_rings
	}

	ai_weight = {
		weight = 50
	}
}

building_corporate_embassy = {
	base_buildtime = @b2_time
	planet_limit = 1

	owner_type = corporate

	category = government

	potential = {
		has_branch_office = yes
		branch_office_owner = {
			is_legit_or_legal_criminal = yes
		}
	}

	allow = {
		has_major_upgraded_capital = yes
	}

	prerequisites = {
		"tech_xeno_diplomacy"
	}

	show_tech_unlock_if = {
		is_megacorp = yes
		is_criminal_syndicate = no
	}

	country_modifier = {
		diplo_weight_economy_mult = 0.05
	}

	planet_modifier = {
		job_clerk_add = 200
	}

	inline_script = {
		script = "jobs/politician_add"
		AMOUNT = 100
	}

	triggered_planet_modifier = {
		potential = {
			always = yes
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_brand_loyalty
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		planet_jobs_trade_produces_mult = 0.005
		mult = value:num_jobs_with_tag|TAG|trade|
	}

	#Crims cause crime even with deal
	triggered_planet_modifier = {
		potential = {
			branch_office_owner = {
				is_criminal_syndicate = yes
			}
		}
		planet_crime_floor_add = @crime_floor_from_legal_crime
	}

	#Trader Jobs from civics
	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_brand_loyalty
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	triggered_country_modifier = {
		potential = {
			branch_office_owner = {
				has_valid_civic = civic_corporate_guided_sapience
			}
		}
		job_capital_trader_add = @traders_from_civic
	}

	custom_tooltip = trade_value_from_traders

	resources = {
		category = planet_branch_office_buildings
		cost = {
			influence = 25
			minerals = @b3_minerals
		}
		cost = {
			trigger = {
				owner = {
					has_authority = auth_corporate
				}
			}
			influence = 25
		}
		upkeep = {
			energy = 3
		}
	}

	destroy_trigger = {
		exists = owner
		branch_office_owner = { is_illegal_criminal = yes }
	}

	convert_to = {
		building_disinformation_center
	}

	ai_weight = {
		weight = 50
		modifier = {
			factor = 10
			branch_office_owner = {
				is_galactic_community_member = yes
			}
		}
	}
}