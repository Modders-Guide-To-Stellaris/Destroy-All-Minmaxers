resolution_declare_crisis = {
    icon = "GFX_resolution_declare_crisis"

    resources = {
        category = resolutions
        cost = {
            influence = @resolution_cost_t5
        }
    }

    target = yes
    harmful = yes

    valid_target = {
        NOT = { is_same_value = from }
        OR = {
            is_country_type = default
            AND = {
                is_fallen_empire = yes
                NOT = { has_global_flag = war_in_heaven_ongoing }
            }
        }
        NOT = { has_country_flag = declared_crisis }
    }

    modifier = {
        starbase_shipyard_build_speed_mult = 0.20
        ships_upkeep_mult = -0.1
    }

    effect = {
        custom_tooltip = resolution_declare_crisis_tooltip
        hidden_effect = {
            if = {
                limit = { is_galactic_community_member = yes }
                remove_from_galactic_community = yes
            }
            if = {
                limit = {
                    is_galactic_council_established = yes
                    is_part_of_galactic_council = yes
                }
                remove_from_galactic_council = yes
            }
            every_subject = {
                if = {
                    limit = { is_galactic_community_member = yes }
                    remove_from_galactic_community = yes
                }
                if = {
                    limit = {
                        is_galactic_council_established = yes
                        is_part_of_galactic_council = yes
                    }
                    remove_from_galactic_council = yes
                }
            }
            set_country_flag = declared_crisis
            save_event_target_as = new_crisis
            country_event = { id = crisis.4105 }
            every_playable_country = {
                limit = {
                    is_ai = no
                    NOT = { is_same_value = prev }
                }
                country_event = { id = crisis.4100 }
            }
            if = {
                limit = { has_galactic_custodian = yes }
                galactic_custodian = {
                    save_event_target_as = community_war_leader
                    if = {
                        limit = { is_in_federation_with = event_target:new_crisis }
                        event_target:new_crisis = {
                            leave_alliance = { override_requirements = yes }
                        }
                    }
                }
            }
            else_if = {
                limit = { has_galactic_emperor = yes }
                galactic_emperor = {
                    save_event_target_as = community_war_leader
                }
            }
            else = {
                random_playable_country = {
                    limit = {
                        is_galactic_community_member = yes
                        NOT = { is_in_federation_with = event_target:new_crisis }
                    }
                    weights = {
                        base = 1
                        modifier = {
                            add = 10000
                            galactic_community_rank = 1
                        }
                        modifier = {
                            add = 1000
                            galactic_community_rank = 2
                        }
                        modifier = {
                            add = 100
                            galactic_community_rank = 3
                        }
                        modifier = {
                            add = 10
                            is_galactic_council_established = yes
                            is_part_of_galactic_council = yes
                        }
                    }
                    save_event_target_as = community_war_leader
                }
            }

            declare_crisis_war_effect = yes
        }
    }

    potential = {
        has_nemesis = yes
        has_galactic_emperor = no
        is_part_of_galactic_council = yes
    }

    ai_weight = {
        base = 0
    }
}
#imperium vv
resolution_declare_crisis_empire = {
    icon = "GFX_resolution_declare_crisis"

    resources = {
        category = resolutions
        cost = {
            influence = @resolution_cost_t5
        }
    }

    target = yes
    harmful = yes

    valid_target = {
        NOT = { is_same_value = from }
        is_galactic_emperor = no
        OR = {
            is_country_type = default
            AND = {
                is_fallen_empire = yes
                NOT = { has_global_flag = war_in_heaven_ongoing }
            }
        }
        NOT = { has_country_flag = declared_crisis }
    }

    modifier = {
        starbase_shipyard_build_speed_mult = 0.20
        ships_upkeep_mult = -0.1
    }

    effect = {
        custom_tooltip = resolution_declare_crisis_empire_tooltip
        hidden_effect = {
            if = {
                limit = { is_galactic_community_member = yes }
                remove_from_galactic_community = yes
            }
            if = {
                limit = {
                    is_galactic_council_established = yes
                    is_part_of_galactic_council = yes
                }
                remove_from_galactic_council = yes
            }
            every_subject = {
                if = {
                    limit = { is_galactic_community_member = yes }
                    remove_from_galactic_community = yes
                }
                if = {
                    limit = {
                        is_galactic_council_established = yes
                        is_part_of_galactic_council = yes
                    }
                    remove_from_galactic_council = yes
                }
            }

            set_country_flag = declared_crisis
            save_event_target_as = new_crisis
            country_event = { id = crisis.4106 }
            every_playable_country = {
                limit = {
                    is_ai = no
                    NOT = { is_same_value = prev }
                }
                country_event = { id = crisis.4101 }
            }
            galactic_emperor = {
                save_event_target_as = community_war_leader
            }
            declare_crisis_war_effect = yes
        }
    }

    potential = {
        has_galactic_emperor = yes
        has_nemesis = yes
        is_part_of_galactic_council = yes
    }

    ai_weight = {
        base = 0
    }
}